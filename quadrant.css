/* ========== Quadrant Chart Mode ========== */

/* ---------- Mode toggle ---------- */
.mode-toggle-wrap{
  display:flex;align-items:center;justify-content:center;
  gap:0;margin:0 auto 14px;
  background:var(--card);
  border:1px solid var(--border);
  border-radius:14px;
  padding:4px;
  max-width:320px;
  width:100%;
}
.mode-toggle-btn{
  flex:1;
  display:flex;align-items:center;justify-content:center;gap:6px;
  height:40px;padding:0 14px;
  border-radius:10px;
  font-weight:700;font-size:13px;letter-spacing:.3px;
  color:var(--muted);
  background:transparent;
  border:none;cursor:pointer;
  transition:background .2s ease,color .2s ease,box-shadow .2s ease;
}
.mode-toggle-btn.active{
  background:var(--accent);
  color:#fff;
  box-shadow:0 2px 10px rgba(139,125,255,.35);
}
.mode-toggle-btn:not(.active):hover{
  background:rgba(139,125,255,.1);
  color:var(--text);
}
.mode-toggle-btn svg{width:16px;height:16px;flex-shrink:0}

/* ---------- Quadrant board container ---------- */
#quadrantBoard{display:none}
#quadrantBoard.active{display:block}
#tierBoard.hidden-mode{display:none}

/* ---------- Axis labels ---------- */
.q-axis-label{
  font-weight:800;font-size:clamp(12px,1.5vw,16px);
  text-transform:uppercase;letter-spacing:1px;
  color:var(--text);
  text-align:center;
  padding:6px 10px;
  min-height:28px;
  outline:none;
  border-radius:8px;
  transition:background .15s ease,color .15s ease;
  line-height:1.2;
}
.q-axis-label:focus{
  background:rgba(139,125,255,.12);
}
.q-axis-label:empty::before{
  content:attr(data-placeholder);
  color:var(--muted);
  opacity:.5;
}

.q-labels-row{
  display:flex;align-items:center;justify-content:center;
  gap:4px;
}
.q-labels-col{
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  gap:4px;
  writing-mode:vertical-lr;
  min-width:32px;
}
.q-labels-col .q-axis-label{
  writing-mode:vertical-lr;
  text-orientation:mixed;
  transform:rotate(180deg);
}
.q-labels-col-right{
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  gap:4px;
  writing-mode:vertical-lr;
  min-width:32px;
}
.q-labels-col-right .q-axis-label{
  writing-mode:vertical-lr;
  text-orientation:mixed;
}

/* ---------- Main quadrant grid ---------- */
.q-outer{
  display:grid;
  grid-template-columns:auto 1fr auto;
  grid-template-rows:auto 1fr auto;
  gap:0;
  max-width:100%;
}
.q-top-label{grid-column:2;grid-row:1;justify-self:center;padding-bottom:6px}
.q-bottom-label{grid-column:2;grid-row:3;justify-self:center;padding-top:6px}
.q-left-label{grid-column:1;grid-row:2;align-self:center;padding-right:6px}
.q-right-label{grid-column:3;grid-row:2;align-self:center;padding-left:6px}

.q-grid-wrap{
  grid-column:2;grid-row:2;
  display:grid;
  grid-template-columns:1fr 1fr;
  grid-template-rows:1fr 1fr;
  gap:0;
  border-radius:16px;
  overflow:hidden;
  border:3px solid var(--q-line-color, rgba(255,255,255,.2));
  box-shadow:var(--shadow);
  /* Aspect ratio to keep it roughly square */
  min-height:420px;
}
:root[data-theme="light"] .q-grid-wrap{
  --q-line-color:rgba(0,0,0,.18);
}
:root:not([data-theme="light"]) .q-grid-wrap{
  --q-line-color:rgba(255,255,255,.2);
}

/* ---------- Individual quadrant zones ---------- */
.q-zone{
  position:relative;
  overflow:hidden;
  min-height:200px;
  transition:background .25s ease;
  cursor:crosshair;
}
/* Thick inner lines via borders on individual quadrants */
.q-zone--tl{border-right:2px solid var(--q-line-color, rgba(255,255,255,.2));border-bottom:2px solid var(--q-line-color, rgba(255,255,255,.2))}
.q-zone--tr{border-left:2px solid var(--q-line-color, rgba(255,255,255,.2));border-bottom:2px solid var(--q-line-color, rgba(255,255,255,.2))}
.q-zone--bl{border-right:2px solid var(--q-line-color, rgba(255,255,255,.2));border-top:2px solid var(--q-line-color, rgba(255,255,255,.2))}
.q-zone--br{border-left:2px solid var(--q-line-color, rgba(255,255,255,.2));border-top:2px solid var(--q-line-color, rgba(255,255,255,.2))}

/* Default quadrant colors — dark mode */
.q-zone--tl{background:rgba(239,68,68,.12)}   /* red tint */
.q-zone--tr{background:rgba(34,197,94,.12)}    /* green tint */
.q-zone--bl{background:rgba(251,191,36,.12)}   /* amber tint */
.q-zone--br{background:rgba(59,130,246,.12)}   /* blue tint */

/* Default quadrant colors — light mode */
:root[data-theme="light"] .q-zone--tl{background:rgba(239,68,68,.08)}
:root[data-theme="light"] .q-zone--tr{background:rgba(34,197,94,.08)}
:root[data-theme="light"] .q-zone--bl{background:rgba(251,191,36,.08)}
:root[data-theme="light"] .q-zone--br{background:rgba(59,130,246,.08)}

/* Quadrant zone label (corner) */
.q-zone-label{
  position:absolute;
  font-weight:800;font-size:11px;letter-spacing:.5px;
  text-transform:uppercase;
  color:var(--muted);
  opacity:.45;
  padding:8px 10px;
  pointer-events:none;
  user-select:none;
  line-height:1;
}
.q-zone--tl .q-zone-label{top:0;left:0}
.q-zone--tr .q-zone-label{top:0;right:0}
.q-zone--bl .q-zone-label{bottom:0;left:0}
.q-zone--br .q-zone-label{bottom:0;right:0}

/* ---------- Per-quadrant color picker ---------- */
.q-color-pick{
  position:absolute;
  width:24px;height:24px;border-radius:999px;
  display:grid;place-items:center;cursor:pointer;z-index:8;
  border:none;box-shadow:none;background:none;padding:0;
  opacity:0;transform:scale(0.5);
  transition:opacity .25s ease,transform .35s cubic-bezier(.34,1.56,.64,1);
}
.q-zone:hover .q-color-pick,
.q-zone:focus-within .q-color-pick{
  opacity:1;transform:scale(1);
  animation:dot-pulse 1.8s ease-in-out infinite;
}
.q-color-pick:active{transform:scale(.85);animation:none}
.q-color-dot{
  width:20px;height:20px;border-radius:999px;display:block;
  box-shadow:0 2px 6px rgba(0,0,0,.3);
  transition:background .2s ease;
}
.q-color-input{position:absolute;width:1px;height:1px;opacity:0;overflow:hidden;border:0;padding:0;clip:rect(0 0 0 0)}

/* Position color pickers in opposite corners from zone labels */
.q-zone--tl .q-color-pick{bottom:8px;right:8px}
.q-zone--tr .q-color-pick{bottom:8px;left:8px}
.q-zone--bl .q-color-pick{top:8px;right:8px}
.q-zone--br .q-color-pick{top:8px;left:8px}

/* ---------- Quadrant drag-over ---------- */
.q-zone.drag-over{
  box-shadow:inset 0 0 0 3px rgba(139,125,255,.4);
}

/* ---------- Quadrant tokens (smaller) ---------- */
.q-zone .token{
  position:absolute;
  width:65px;height:65px;
  z-index:5;
  cursor:grab;
  /* Remove grid-based positioning */
  margin:0;
}
.q-zone .token:active{cursor:grabbing}
.q-zone .token .label{
  font-weight:900;
  font-size:13px;
  padding:4px;
}
.q-zone .token img{
  width:100%;height:100%;object-fit:cover;border-radius:999px;pointer-events:none;
}
/* Ghost for quadrant drag — smaller to match */
.q-drag-ghost{
  position:fixed;left:0;top:0;z-index:50;pointer-events:none;
  width:65px;height:65px;border-radius:999px;
  opacity:.92;transform:translate3d(0,0,0) scale(1.08);
  box-shadow:0 12px 32px rgba(0,0,0,.4);
  /* Prevent ghost from causing viewport overflow */
  will-change:transform;
}

/* Lock viewport during quadrant drag to prevent page shrink */
body.q-dragging{
  overflow:hidden !important;
  touch-action:none !important;
  -webkit-user-select:none !important;
  user-select:none !important;
}
html.q-dragging-lock{
  overflow:hidden !important;
}
}

/* ---------- "Add Tier" hidden in quadrant mode ---------- */
body.quadrant-mode #addTierBtn{display:none}

/* ---------- Responsive ---------- */
@media (max-width:768px){
  .q-grid-wrap{min-height:320px}
  .q-zone{min-height:150px}
  .q-zone .token{width:55px;height:55px}
  .q-zone .token .label{font-size:11px;font-weight:900;padding:3px}
  .q-drag-ghost{width:55px;height:55px}
  .q-axis-label{font-size:11px;padding:4px 6px}
  .mode-toggle-wrap{max-width:280px}
  .mode-toggle-btn{height:36px;font-size:12px}
}
@media (max-width:480px){
  .q-grid-wrap{min-height:260px}
  .q-zone{min-height:120px}
  .q-zone .token{width:48px;height:48px}
  .q-zone .token .label{font-size:10px;font-weight:900;padding:2px}
  .q-drag-ghost{width:48px;height:48px}
  .mode-toggle-wrap{max-width:260px}
}

/* ---------- Export overrides (for save-as-PNG) ---------- */
.q-export-mode .q-color-pick{display:none !important}
.q-export-mode .q-zone-label{display:none !important}
.q-export-mode .mode-toggle-wrap{display:none !important}
